<head>
  <script type="text/javascript">
   window.onload = function(){
   var versions = ["latest","4.3.0","4.2.2","4.2.1","4.2.0","4.1.4","4.1.3","4.1.2","4.1.1","4.1.0","4.0.0","3.8.6"];
   var select = document.getElementById("select_version");
   var currVersion = getCurrentVersion();
   
   // This show tower version only on those Docs which will be there in the Controller as well and Also populates the Version menu 
   var current_url = location+"";
   for (const val of versions) {
    
    if((val[0] == "4") && current_url.includes("quickinstall") || current_url.includes("installandreference")){
      continue;  
    }

    var option = document.createElement("option");

    if(val == currVersion){
     option.selected = "selected";
    }
    option.value = val;
    option.text = val;
    select.appendChild(option);
   }
  };

  // change the URL according to the version

  function getDynamicUrl(value){
     var current_url = location+"";
     var result = "";
     if(value == "latest"){
      result = current_url.replace(getCurrentVersion(), value);
     }
     else if(value[0] == "4" ){
        result = current_url.replace("ansible-tower" , "automation-controller");
        result = result.replace("towerapi" , "controllerapi");
        result = result.replace("towercli" , "controllercli");
        result = result.replace(getCurrentVersion(), value);
       }
     else{
       result = current_url.replace("automation-controller" , "ansible-tower");
       result = result.replace("controllerapi" , "towerapi" );
       result = result.replace("controllercli" , "towercli" );
       result = result.replace(getCurrentVersion(), value);
      }
      
      return result;
     }

  // This is to get the current version of the DOC
  function getCurrentVersion(){
    var current_url = location+"";
    var split = current_url.split("/");
    return split[4];
    }

  </script>

 </head>

<body>
  <select id="select_version" onchange="location = getDynamicUrl(this.value); ">
  </select> 
</body>
