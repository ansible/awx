input {
    http {
        port => 8085
        user => awx_logger
        password => "workflows"
    }
}

## Add your filters / logstash plugins configuration here

filter {
    json {
        source => "message"
        remove_field => [ "headers" ]
    }
    if [start] {
        mutate {
            add_tag => [ "START_PIPELINE_STEP" ]
        }
    }
    if [end] {
        mutate {
            add_tag => [ "END_PIPELINE_STEP" ]
        }
    }
    elapsed {
        unique_id_field => "correlation_id"
        start_tag => "START_PIPELINE_STEP"
        end_tag => "END_PIPELINE_STEP"
    }
}

output {
    elasticsearch {
        hosts => "elasticsearch:9200"
    }
    #stdout { codec => json }
}
