---
- name: Build and deploy AWX
  hosts: all
  gather_facts: false

  pre_tasks:
    - include: provision_el.yml
      when: 
        - openshift_host is not defined or openshift_host == ''
        - ansible_os_family == "RedHat"

  roles:
    - { role: check_vars }
    - { role: image_build }
    - { role: openshift, when: "openshift_host is defined" }
    - { role: local_docker, when: "openshift_host is not defined" }

